pipeline {
    agent any
    stages {
        stage('Deploy to Railway') {
            steps {
                withCredentials([string(credentialsId: 'railway-api-token', variable: 'TOKEN')]) {
                    bat """
                    set RAILWAY_TOKEN=%TOKEN%
                    railway whoami
                    railway up --service spring-petclinic-app --detach
                    """
                }
            }
        }
    }
}
